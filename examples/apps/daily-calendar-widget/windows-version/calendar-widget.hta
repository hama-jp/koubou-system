<html>
<head>
<HTA:APPLICATION 
    ID="CalendarWidget"
    APPLICATIONNAME="Calendar"
    BORDER="none"
    CAPTION="no"
    SHOWINTASKBAR="yes"
    SINGLEINSTANCE="yes"
    SYSMENU="no"
    SCROLL="no"
    WINDOWSTATE="normal"
/>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Calendar Widget</title>
<style type="text/css">
body {
  margin: 0;
  padding: 0;
  font-family: Meiryo, sans-serif;
  background: white;
  overflow: hidden;
}

#main {
  width: 200px;
  height: 180px;
  padding: 15px;
  text-align: center;
  border: 1px solid #ddd;
  background: linear-gradient(to bottom, #ffffff, #f8f8f8);
  box-shadow: 0 2px 10px rgba(0,0,0,0.2);
  border-radius: 8px;
}

#closeBtn {
  position: absolute;
  top: 8px;
  right: 8px;
  width: 16px;
  height: 16px;
  background: #ff5555;
  color: white;
  border: none;
  border-radius: 50%;
  cursor: pointer;
  font-size: 10px;
  font-weight: bold;
  line-height: 14px;
}

#yearMonth {
  font-size: 14px;
  color: #666;
  margin: 5px 0;
}

#dateNum {
  font-size: 60px;
  font-weight: bold;
  color: #333;
  margin: 10px 0;
}

#weekDay {
  font-size: 20px;
  font-weight: bold;
  margin: 10px 0;
}

.sunday { color: red; }
.saturday { color: blue; }
.weekday { color: black; }

</style>
<script language="JScript">
var isDragging = false;
var mouseX = 0;
var mouseY = 0;

function windowLoad() {
  // Window size (smaller without rokuyou)
  window.resizeTo(230, 210);
  
  // Position bottom right
  var sw = window.screen.availWidth;
  var sh = window.screen.availHeight;
  window.moveTo(sw - 250, sh - 240);
  
  // Start updates
  updateDisplay();
  window.setInterval(updateDisplay, 60000);
}

function updateDisplay() {
  var d = new Date();
  var y = d.getFullYear();
  var m = d.getMonth() + 1;
  var dt = d.getDate();
  var dy = d.getDay();
  
  var weekNames = ['日', '月', '火', '水', '木', '金', '土'];
  
  // Year Month
  document.getElementById('yearMonth').innerHTML = y + '年' + m + '月';
  
  // Date
  document.getElementById('dateNum').innerHTML = dt;
  
  // Weekday
  var wdElement = document.getElementById('weekDay');
  wdElement.innerHTML = weekNames[dy] + '曜日';
  
  // Color by day
  if (dy == 0) {
    wdElement.style.color = 'red';
  } else if (dy == 6) {
    wdElement.style.color = 'blue';
  } else {
    wdElement.style.color = 'black';
  }
  
  // Check holiday
  if (checkHoliday(m, dt)) {
    wdElement.style.color = 'red';
  }
}

function checkHoliday(m, d) {
  // Simple holiday list
  var hList = '1-1,2-11,2-23,4-29,5-3,5-4,5-5,8-11,11-3,11-23';
  var checkStr = m + '-' + d;
  
  if (hList.indexOf(checkStr) >= 0) {
    return true;
  }
  return false;
}

function dragStart() {
  if (window.event.srcElement.id == 'closeBtn') {
    return;
  }
  isDragging = true;
  mouseX = window.event.clientX;
  mouseY = window.event.clientY;
}

function dragMove() {
  if (!isDragging) return;
  
  var newX = window.event.clientX;
  var newY = window.event.clientY;
  
  window.moveBy(newX - mouseX, newY - mouseY);
}

function dragEnd() {
  isDragging = false;
}

function closeApp() {
  window.close();
}
</script>
</head>
<body onload="windowLoad()" onmousedown="dragStart()" onmousemove="dragMove()" onmouseup="dragEnd()">

<div id="main">
  <button id="closeBtn" onclick="closeApp()">X</button>
  <div id="yearMonth"></div>
  <div id="dateNum"></div>
  <div id="weekDay"></div>
</div>

</body>
</html>